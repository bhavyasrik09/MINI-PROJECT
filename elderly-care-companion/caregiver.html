<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Caregiver Dashboard</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/caregiver.css">
</head>
<body>
  <div class="app-wrapper">
    <nav class="navbar">
      <div class="navbar-brand">
        <span class="app-icon">â¤ï¸</span>
        <span class="app-title">Care Monitor</span>
      </div>
      <div class="nav-tabs">
        <button class="nav-tab active" data-tab="overview">
          <span class="tab-icon">ğŸ“Š</span>
          <span class="tab-label">Overview</span>
        </button>
        <button class="nav-tab" data-tab="medicines">
          <span class="tab-icon">ğŸ’Š</span>
          <span class="tab-label">Medicines</span>
        </button>
        <button class="nav-tab" data-tab="appointments">
          <span class="tab-icon">ğŸ“…</span>
          <span class="tab-label">Appointments</span>
        </button>
        <button class="nav-tab" data-tab="alerts">
          <span class="tab-icon">ğŸš¨</span>
          <span class="tab-label">SOS Alerts</span>
        </button>
      </div>
    </nav>

    <main class="main-content">
      <!-- OVERVIEW TAB -->
      <div class="tab-content active" id="tab-overview">
        <div class="container">
          <h2>Dashboard Overview</h2>
          <div id="status-cards"></div>
          <div class="care-help-panel">
            <strong>â„¹ï¸ Caregiver Tips:</strong>
            <p>Monitor medicines, appointments, and SOS events in real-time. Page refreshes every 5 seconds. Click tabs for detailed views.</p>
            <button class="btn-secondary" onclick="dashboard.render()">Refresh Now</button>
          </div>
        </div>
      </div>

      <!-- MEDICINES TAB -->
      <div class="tab-content" id="tab-medicines">
        <div class="container">
          <h2>Medicine Compliance</h2>
          <div class="card">
            <h3>Today's Medicines</h3>
            <ul id="med-status-list"></ul>
          </div>
        </div>
      </div>

      <!-- APPOINTMENTS TAB -->
      <div class="tab-content" id="tab-appointments">
        <div class="container">
          <h2>Scheduled Appointments</h2>
          <div class="card">
            <h3>Upcoming Appointments</h3>
            <ul id="appointment-status-list"></ul>
          </div>
        </div>
      </div>

      <!-- ALERTS TAB -->
      <div class="tab-content" id="tab-alerts">
        <div class="container">
          <h2>SOS & Emergency Alerts</h2>
          <div class="card">
            <h3>Recent SOS Events</h3>
            <ul id="sos-list"></ul>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="js/storage.js"></script>
  <script src="js/dashboard.js"></script>
  <script>
    // TAB NAVIGATION
    function setupCaregiversTabs(){
      document.querySelectorAll('.nav-tab').forEach(btn=>{
        btn.addEventListener('click', (e)=>{
          e.preventDefault();
          const tabName = btn.dataset.tab;
          document.querySelectorAll('.nav-tab').forEach(b=> b.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c=> c.classList.remove('active'));
          btn.classList.add('active');
          document.getElementById(`tab-${tabName}`).classList.add('active');
        });
      });
    }
    window.addEventListener('load', ()=>{
      setupCaregiversTabs();
      dashboard.render();
      setInterval(dashboard.render, 5000);
    });

    // APPOINTMENTS LIST
    function renderAppointmentsList(){
      const ul = document.getElementById('appointment-status-list');
      if(!ul) return;
      ul.innerHTML = '';
      const apps = storage.getAppointments();
      if(apps.length === 0) ul.innerHTML = '<li>No appointments scheduled</li>';
      else apps.forEach(a=>{
        const li = document.createElement('li');
        const phonePart = a.phone? ` â€” <a href="tel:${a.phone}">Call</a>`: '';
        li.innerHTML = `<strong>${a.title}</strong> â€” ${a.datetime}${phonePart}`;
        ul.appendChild(li);
      });
    }
    window.addEventListener('load', renderAppointmentsList);
  </script>
</body>
</html>